<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Documentation Index</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.spacelab.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Documentation</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="module-compile-html.html">compile-html</a>
						</li>
						
						<li>
							<a href="module-compiler-css.html">compiler-css</a>
						</li>
						
						<li>
							<a href="module-compiler-js.html">compiler-js</a>
						</li>
						
						<li>
							<a href="module-node.html">node</a>
						</li>
						
						<li>
							<a href="module-project.html">project</a>
						</li>
						
						<li>
							<a href="module-source.html">source</a>
						</li>
						
						<li>
							<a href="module-template.html">template</a>
						</li>
						
						<li>
							<a href="module-tfw.html">tfw</a>
						</li>
						
						<li>
							<a href="module-util.html">util</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="module-project-Project.html">project~Project</a>
						</li>
						
						<li>
							<a href="module-source-Source.html">source~Source</a>
						</li>
						
						<li>
							<a href="module-util-Dependencies.html">util~Dependencies</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
		<div class="span8">
			
				<div id="main">
					


	
	<span class="page-title">Index</span>
	
	












	
	





    <section class="readme-section">
        <article><h1>ToloFrameWork</h1><h2>Organisation of the source folder</h2><ul>
<li><code>project.tfw.json</code>: project's configuration file.</li>
<li><code>doc/</code>: auto-generated documentation.</li>
<li><code>src/</code>: HTML source files.<ul>
<li><code>src/cls/</code>: javascript classes.</li>
<li><code>src/wdg/</code>: widgets' folder.</li>
</ul>
</li>
<li><code>tmp/</code>: files used by the compiler to link the project.</li>
<li><code>www/</code>: resulting project.</li>
</ul>
<h2>Compilation process step by step</h2><p>For each HTML file (extension <code>*.html</code>) in the directory <code>src/</code>, <strong>TFW</strong> will create an HTML file with the same name in the resulting directory <code>www/</code>. From this we can deduce the <code>*.css</code> and <code>*.js</code> files to compile.</p>
<h3>HTML file</h3>

<h4>Inner styles and javascripts</h4>

<p>We want all the javascript and CSS outside the HTML file. First for clarity reason and also besauce Firefox OS doesn't grant web apps if the javascript is not externalized in a separate file.</p>
<p>We put scripts code into the tag <strong><code>innerJS</code></strong> and CSS code into <strong><code>innerCSS</code></strong>.</p>
<h4>Outer styles and javascripts</h4>

<p>We look for this kind of tags:</p>
<pre class="prettyprint source lang-xml"><code>&lt;link href=&quot;mystyle.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; />
&lt;script src=&quot;myscript.js&quot;>&lt;/script></code></pre><p>The tag <strong><code>outerJS</code></strong> will be an array of javascript files relative to the HTML file, and <strong><code>outerCSS</code></strong> an array of CSS files.</p>
<h4>Widgets</h4>

<p>All elements with the namespace <code>w:</code> are widgets. If the HTML file contains, for instance, the widgets <code>&lt;w:foo&gt;</code> and <code>&lt;w:bar&gt;</code>, we put <code>[&quot;wdg/foo/compile-foo.js&quot;, &quot;wdg/bar/compile-bar.js&quot;]</code> into the tag <strong><code>dependencies</code></strong>.<br>Then we eventually add the content of <code>root.extra.css</code> to the tag <strong><code>innerCSS</code></strong>.</p>
<h4>The whole final HTML tree</h4>

<p>There is a last piece of javascript the compiler must write: it deals with <em>databindings</em> and <em>controllers</em>.<br>Bindable data are scoped, so we must add the property <code>$data</code> to some DOM elements. For <em>controllers</em>, we use the property <code>$widget</code>, but this is not visible in the script because all controllers inherit from <code>WTag</code> class which is responsible of attaching this property.</p>
<p>Here is an example of such a script:</p>
<pre class="prettyprint source lang-js"><code>window.addEventListener(
    'DOMContentLoaded',
    function() {
        document.body.parentNode.$data = {};
        var binddata = function(id, name, value) {
            if (typeof document.getElementById(id).$data === 'undefined') {
               document.getElementById(id).$data = {}
            }
            document.getElementById(id).$data[name] = [value, []];
        };
        binddata(5, &quot;score&quot;, 0);
        $$('wtag.Button', {id: 7, fire: [&quot;@popup&quot;], fireArg: [&quot;hello&quot;]});
        $$('wtag.List', {
            id: 11,
            maker: function(tpl,id) {
                id += '.';
                $$('wtag.Bind', {id: id + 10, data: &quot;user&quot;});
                $$('wtag.Bind', {id: id + 11, data: &quot;yourname&quot;});
            },
            tpl: 12,
            list: &quot;users&quot;,
            item: &quot;user&quot;
        });
        document.body.$widget = $$.App = $$('Main', {id: document.body});
        $$.App.lang($$.App.lang());
        document.body.removeChild(document.getElementById('15'))
    }
);</code></pre><ul>
<li><strong>line 2</strong>: ensure that this will be executed after le DOM is fully loaded.</li>
<li><strong>line 4</strong>: the HTML root element own the global databinding scope.</li>
<li><strong>line 5</strong>: function used for local scoped data bindings.</li>
<li><strong>line 11</strong>: this line is generated by a Top-Down walk in the tree, if we find <code>extra.databindings</code>.</li>
<li><strong>line 12</strong>: from here we walk the tree Bottom-Up and attach controllers. 
In this line, we found <code>extra.controller = &quot;wtag.Button&quot;</code> and 
<code>extra.init = {id: 7, fire: [&quot;@popup&quot;], fireArg: [&quot;hello&quot;]}</code>.</li>
<li><strong>line 13</strong>: this is an example for a more complex widget.</li>
<li><strong>line 24</strong>: if the BODY element has the <code>app</code> attribute, we use it as a top controller.</li>
<li><strong>line 25</strong>: initialization of internationalization.</li>
<li><strong>line 26</strong>: when everything has been successfully initialized, we can remove the black screen.</li>
</ul>
<p>This script is added to the tag <strong><code>innerJS</code></strong>, then we remove all the <code>extra</code> attributes in the tree and we store it in tag <strong><code>tree</code></strong>.</p>
<h4>Summary</h4>

<ul>
<li><strong><code>innerJS</code></strong>: (string) javascript to externalize.</li>
<li><strong><code>zipJS</code></strong>: (string) <code>innerJS</code> zipped for RELEASE.</li>
<li><strong><code>innerCSS</code></strong>: (string) style to externalize.</li>
<li><strong><code>zipCSS</code></strong>: (string) <code>innerCSS</code> zipped for RELEASE.</li>
<li><strong><code>outerJS</code></strong>: (array) javascript files relative to the HTML file path.</li>
<li><strong><code>outerCSS</code></strong>: (array) stylesheet files relative to the HTML file path.</li>
<li><strong><code>linkJS</code></strong>: (array) complete list of javascript files. This is a subset of <strong><code>outerJS</code></strong> because it owns scripts needed by other scripts.</li>
<li><strong><code>dependencies</code></strong>: (array) files that will force recompilation of the HTML files if at least one of them is not uptodate.</li>
<li><strong><code>tree</code></strong>: the final HTMLl tree after removing attributes <code>extra</code>.</li>
</ul>
<h3>Javascript files</h3>

<p>In <strong>ToloFrameWork</strong>, classes intantiations are made with this syntax: <code>$$(&quot;myclass&quot;, {...})</code>.<br>Each time the parser meets such a syntax, it adds the class name (<em>myclass</em>) in the array tag <strong><code>needsJS</code></strong>.</p>
<p>If a CSS file is associated (for instance, we found <code>foo.Bar.css</code> in the same folder as <code>foo.Bar.js</code>) we add it (relative to the HTML file) in tag <strong><code>CSS</code></strong>.</p>
<p>Finaly, we store the zipped version of this script in tag <strong><code>zip</code></strong>.</p>
<ul>
<li><strong><code>needsJS</code></strong>: (array) list of needed classes.</li>
<li><strong><code>css</code></strong>: (string) name of the CSS file relative to this HTML file. It must have the same name, but with extension <code>.css</code>.</li>
<li><strong><code>zip</code></strong>: (string) zipped version of this script for RELEASE purpose.</li>
</ul>
<h3>CSS files</h3>

<p>All CSS used in <strong>TFW</strong> accept the LESS syntax. That's why the first thing to do is store the LESS expansion of the file in tag <strong><code>debug</code></strong>. Then, we zip the result and store it in tag <strong><code>release</code></strong>.</p>
<p>Finaly, we parse the zip CSS looking for <code>url(...)</code>. Each time a URL is related to an existing local file, we add it to the array tag <strong><code>resources</code></strong>.</p>
<ul>
<li><strong><code>debug</code></strong>: (string) CSS code after LESS has expanded it.</li>
<li><strong><code>release</code></strong>: (string) zipped version of <code>debug</code>.</li>
<li><strong><code>resources</code></strong>: (array) zipped version of this script for RELEASE purpose.</li>
</ul>
<h2>Linkage process step by step</h2><p>Whereas compilation occurs only when files change, the linkage process always occurs.</p>
<p>This process will result in the following directories:</p>
<ul>
<li><strong>www/debug/</strong>: DEBUG version of the webapp. 
No zipping, all JS and CSS files are separated.
Inner javascripts are stored in the file <code>index.js</code> and inner styles in <code>index.css</code>.
In this mode, a folder <code>index/</code> is created to store all the JS and CSS files.</li>
<li><strong>www/release/</strong>: RELEASE version of the webapp. 
All JS and CSS files are zipped and aggregated in respectively <code>index.js</code> and <code>index.css</code> files.</li>
</ul>
<p>For both configurations, <code>index.manifest</code> is generated with the current date/time.</p>
<h3>Resources</h3>

<p>CSS tags <strong><code>resources</code></strong> are used to find resources that we will copy on output and reference in the manifest file <code>index.manifest</code>.</p></article>
    </section>







				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a>
		on 2014-10-11T22:29:13+02:00 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<div class="span3">
				<div id="toc"></div>
			</div>
			
			<br clear="both">
		</div>

	</div>
	<!--<script src="scripts/sunlight.js"></script>-->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "100px"
			} );

			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );
			$( '.dropdown-toggle' ).dropdown();
//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( ".tutorial-section pre, .readme-section pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );
		} );
	 </script>



	<!--Navigation and Symbol Display-->
	
	<script>
		$( function () {
			$( '#main' ).localScroll( {
				offset : { top : 60 } //offset by the height of your header (give or take a few px, see what works for you)
			} );
			$( "dt.name" ).each( function () {
				var $this = $( this ).find("h4");
				var icon = $( "<i/>" ).addClass( "icon-plus-sign" ).addClass( "pull-right" ).addClass( "icon-white" );
				var dt = $(this);
				var children = dt.next( "dd" );

				dt.prepend( icon ).css( {cursor : "pointer"} );
				dt.addClass( "member-collapsed" ).addClass( "member" );


				children.hide();

				dt.children().on( "click", function () {
					children = dt.next( "dd" );
					console.debug(dt, children)
					children.slideToggle( "fast", function () {

						if ( children.is( ":visible" ) ) {
							icon.addClass( "icon-minus-sign" ).removeClass( "icon-plus-sign" ).removeClass( "icon-white" );
							dt.addClass( "member-open" ).animate( "member-collapsed" );
						} else {
							icon.addClass( "icon-plus-sign" ).removeClass( "icon-minus-sign" ).addClass( "icon-white" );
							dt.addClass( "member-collapsed" ).removeClass( "member-open" );
						}
					} );
				} );

			} );
		} );
	</script>
	


	<!--Google Analytics-->
	

</body>
</html>