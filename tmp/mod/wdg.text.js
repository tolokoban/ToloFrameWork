{"intl":"","src":"/** @module wdg.text */require( 'wdg.text', function(exports, module) {  var $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar LaterAction = require(\"tfw.timer\").laterAction;\r\n\r\n/**\r\n * @class tfw.edit.text\r\n * @description  HTML5 text input with many options.\r\n *\r\n * __Attributes__:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n */\r\nvar Text = function(opts) {\r\n    var that = this;\r\n\r\n    var label = $.div( 'label' );\r\n    var input = $.tag( 'input' );\r\n    var datalist = $.div( 'datalist' );\r\n    this._input = input;\r\n    var elem = $.elem( this, 'div', 'wdg-text', [label, input, datalist] );\r\n\r\n    DB.propString(this, 'value')(function(v) {\r\n        input.value = v;\r\n        that.validate();\r\n    });\r\n    DB.propEnum(['text', 'button', 'checkbox', 'color', 'date', 'datetime', 'email', 'file',\r\n                 'hidden', 'image', 'month', 'password', 'radio', 'range', 'reset',\r\n                 'search', 'submit', 'tel', 'time', 'url', 'week'])(this, 'type')\r\n    (function(v) {\r\n        $.att(input, {type: v});\r\n    });\r\n    DB.propStringArray(this, 'list')(function(v) {\r\n        $.clear( datalist );\r\n        $.removeClass( elem, \"list\" );\r\n        if (!Array.isArray( v )) return;\r\n        v.forEach(function ( item ) {\r\n            $.add( datalist, $.div( [item] ) );\r\n        });\r\n        $.att( elem, \"list\" );\r\n    });\r\n    DB.propValidator(this, 'validator')(this.validate.bind( this ));\r\n    DB.propBoolean(this, 'valid')(function(v) {\r\n        if (v === null || !that.validator) {\r\n            $.removeClass( elem, \"valid\", \"no-valid\" );\r\n        } else {\r\n            if (v) {\r\n                $.addClass( elem, \"valid\" );\r\n                $.removeClass( elem, \"no-valid\" );\r\n            } else {\r\n                $.removeClass( elem, \"valid\" );\r\n                $.addClass( elem, \"no-valid\" );\r\n            }\r\n        }\r\n    });\r\n    DB.propBoolean(this, 'enabled')(function(v) {\r\n        if (v) {\r\n            $.removeAtt(input, 'disabled');\r\n        } else {\r\n            $.att(input, {disabled: v});\r\n        }\r\n    });\r\n    DB.propInteger(this, 'size')(function(v) {\r\n        if (v < 1) {\r\n            $.removeAtt(input, 'size');\r\n        } else {\r\n            $.att(input, {size: v});\r\n        }\r\n    });\r\n    DB.propString(this, 'label')(function(v) {\r\n        if (v === null || (typeof v === 'string' && v.trim() == '')) {\r\n            $.addClass(elem, 'no-label');\r\n        } else {\r\n            $.removeClass(elem, 'no-label');\r\n            $.textOrHtml(label, v);\r\n            if (v.substr(0, 6) == '<html>') {\r\n                $.att(label, {title: ''});\r\n            } else {\r\n                $.att(label, {title: v});\r\n            }\r\n        }\r\n    });\r\n    DB.propString(this, 'placeholder')(function(v) {\r\n        $.att(input, {placeholder: v});\r\n    });\r\n    DB.propString(this, 'width')(function(v) {\r\n        elem.style.width = v;\r\n    });\r\n    DB.propInteger(this, 'action', '');\r\n\r\n    opts = DB.extend({\r\n        value: '',\r\n        type: 'text',\r\n        placeholder: '',\r\n        enabled: true,\r\n        validator: null,\r\n        valid: true,\r\n        list: null,\r\n        label: null,\r\n        placeholder: '',\r\n        size: 10,\r\n        width: 'auto',\r\n        wide: false,\r\n        visible: true\r\n    }, opts, this);\r\n\r\n    var complete = function() {\r\n        $.removeClass( elem, \"list\" );\r\n        if (!that.list || that.list.length == 0) return;\r\n\r\n        $.clear( datalist );\r\n        var list = that.list.slice();\r\n        \r\n        list.forEach(function (item) {\r\n            var div = $.div();\r\n            div.innerHTML = item;\r\n            $.add( datalist, div );\r\n            $.on( div, {\r\n                'down': function() {\r\n                    that.value = div.textContent.trim();\r\n                }\r\n            });\r\n        });\r\n        \r\n        $.addClass( elem, \"list\" );\r\n    };\r\n\r\n    var actionUpdateValue = LaterAction(function() {\r\n        that.value = input.value;\r\n    }, 300);\r\n    input.addEventListener('keyup', actionUpdateValue.fire.bind( actionUpdateValue ));\r\n    input.addEventListener('blur', function() {\r\n        that.value = input.value;\r\n        $.removeClass( elem, \"list\" );\r\n    });\r\n    input.addEventListener('focus', that.selectAll.bind(that));\r\n    input.addEventListener('keydown', function(evt) {\r\n        complete();\r\n        if (evt.keyCode == 13) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            if (that.valid !== false) {\r\n                DB.fire( that, 'value', input.value );\r\n                DB.fire( that, 'action', input.value );\r\n            }\r\n        }\r\n    });\r\n\r\n    this.validate();\r\n};\r\n\r\n\r\n/**\r\n * Force value validation.\r\n */\r\nText.prototype.validate = function() {\r\n    var validator = this.validator;\r\n    if (!validator) return;\r\n    try {\r\n        this.valid = validator( this.value );\r\n    }\r\n    catch (ex) {\r\n        console.error(\"[wdg.text:validate] Exception = \", ex);\r\n        console.error(\"[wdg.text:validate] Validator = \", validator);\r\n    }\r\n};\r\n\r\n/**\r\n * Select whole text.\r\n * @return {this}\r\n */\r\nText.prototype.selectAll = function() {\r\n    var e = this._input;\r\n    e.setSelectionRange(0, e.value.length);\r\n    return true;\r\n};\r\n\r\nmodule.exports = Text;\r\n\r\n\r\n\r\n \r\n/**\n * @module wdg.text\n * @see module:dom\n * @see module:tfw.data-binding\n * @see module:tfw.timer\n * @see module:wdg.text\n\n */\n});","zip":"require(\"wdg.text\",function(t,e){var i=require(\"dom\"),a=require(\"tfw.data-binding\"),l=require(\"tfw.timer\").laterAction,n=function(t){var e=this,n=i.div(\"label\"),r=i.tag(\"input\"),o=i.div(\"datalist\");this._input=r;var s=i.elem(this,\"div\",\"wdg-text\",[n,r,o]);a.propString(this,\"value\")(function(t){r.value=t,e.validate()}),a.propEnum([\"text\",\"button\",\"checkbox\",\"color\",\"date\",\"datetime\",\"email\",\"file\",\"hidden\",\"image\",\"month\",\"password\",\"radio\",\"range\",\"reset\",\"search\",\"submit\",\"tel\",\"time\",\"url\",\"week\"])(this,\"type\")(function(t){i.att(r,{type:t})}),a.propStringArray(this,\"list\")(function(t){i.clear(o),i.removeClass(s,\"list\"),Array.isArray(t)&&(t.forEach(function(t){i.add(o,i.div([t]))}),i.att(s,\"list\"))}),a.propValidator(this,\"validator\")(this.validate.bind(this)),a.propBoolean(this,\"valid\")(function(t){null!==t&&e.validator?t?(i.addClass(s,\"valid\"),i.removeClass(s,\"no-valid\")):(i.removeClass(s,\"valid\"),i.addClass(s,\"no-valid\")):i.removeClass(s,\"valid\",\"no-valid\")}),a.propBoolean(this,\"enabled\")(function(t){t?i.removeAtt(r,\"disabled\"):i.att(r,{disabled:t})}),a.propInteger(this,\"size\")(function(t){1>t?i.removeAtt(r,\"size\"):i.att(r,{size:t})}),a.propString(this,\"label\")(function(t){null===t||\"string\"==typeof t&&\"\"==t.trim()?i.addClass(s,\"no-label\"):(i.removeClass(s,\"no-label\"),i.textOrHtml(n,t),\"<html>\"==t.substr(0,6)?i.att(n,{title:\"\"}):i.att(n,{title:t}))}),a.propString(this,\"placeholder\")(function(t){i.att(r,{placeholder:t})}),a.propString(this,\"width\")(function(t){s.style.width=t}),a.propInteger(this,\"action\",\"\"),t=a.extend({value:\"\",type:\"text\",placeholder:\"\",enabled:!0,validator:null,valid:!0,list:null,label:null,placeholder:\"\",size:10,width:\"auto\",wide:!1,visible:!0},t,this);var d=function(){if(i.removeClass(s,\"list\"),e.list&&0!=e.list.length){i.clear(o);var t=e.list.slice();t.forEach(function(t){var a=i.div();a.innerHTML=t,i.add(o,a),i.on(a,{down:function(){e.value=a.textContent.trim()}})}),i.addClass(s,\"list\")}},v=l(function(){e.value=r.value},300);r.addEventListener(\"keyup\",v.fire.bind(v)),r.addEventListener(\"blur\",function(){e.value=r.value,i.removeClass(s,\"list\")}),r.addEventListener(\"focus\",e.selectAll.bind(e)),r.addEventListener(\"keydown\",function(t){d(),13==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.valid!==!1&&(a.fire(e,\"value\",r.value),a.fire(e,\"action\",r.value)))}),this.validate()};n.prototype.validate=function(){var t=this.validator;if(t)try{this.valid=t(this.value)}catch(e){console.error(\"[wdg.text:validate] Exception = \",e),console.error(\"[wdg.text:validate] Validator = \",t)}},n.prototype.selectAll=function(){var t=this._input;return t.setSelectionRange(0,t.value.length),!0},e.exports=n});\n//# sourceMappingURL=wdg.text.js.map","map":{"version":3,"file":"wdg.text.js.map","sources":["wdg.text.js"],"sourcesContent":["/** @module wdg.text */require( 'wdg.text', function(exports, module) {  var $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar LaterAction = require(\"tfw.timer\").laterAction;\r\n\r\n/**\r\n * @class tfw.edit.text\r\n * @description  HTML5 text input with many options.\r\n *\r\n * __Attributes__:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n */\r\nvar Text = function(opts) {\r\n    var that = this;\r\n\r\n    var label = $.div( 'label' );\r\n    var input = $.tag( 'input' );\r\n    var datalist = $.div( 'datalist' );\r\n    this._input = input;\r\n    var elem = $.elem( this, 'div', 'wdg-text', [label, input, datalist] );\r\n\r\n    DB.propString(this, 'value')(function(v) {\r\n        input.value = v;\r\n        that.validate();\r\n    });\r\n    DB.propEnum(['text', 'button', 'checkbox', 'color', 'date', 'datetime', 'email', 'file',\r\n                 'hidden', 'image', 'month', 'password', 'radio', 'range', 'reset',\r\n                 'search', 'submit', 'tel', 'time', 'url', 'week'])(this, 'type')\r\n    (function(v) {\r\n        $.att(input, {type: v});\r\n    });\r\n    DB.propStringArray(this, 'list')(function(v) {\r\n        $.clear( datalist );\r\n        $.removeClass( elem, \"list\" );\r\n        if (!Array.isArray( v )) return;\r\n        v.forEach(function ( item ) {\r\n            $.add( datalist, $.div( [item] ) );\r\n        });\r\n        $.att( elem, \"list\" );\r\n    });\r\n    DB.propValidator(this, 'validator')(this.validate.bind( this ));\r\n    DB.propBoolean(this, 'valid')(function(v) {\r\n        if (v === null || !that.validator) {\r\n            $.removeClass( elem, \"valid\", \"no-valid\" );\r\n        } else {\r\n            if (v) {\r\n                $.addClass( elem, \"valid\" );\r\n                $.removeClass( elem, \"no-valid\" );\r\n            } else {\r\n                $.removeClass( elem, \"valid\" );\r\n                $.addClass( elem, \"no-valid\" );\r\n            }\r\n        }\r\n    });\r\n    DB.propBoolean(this, 'enabled')(function(v) {\r\n        if (v) {\r\n            $.removeAtt(input, 'disabled');\r\n        } else {\r\n            $.att(input, {disabled: v});\r\n        }\r\n    });\r\n    DB.propInteger(this, 'size')(function(v) {\r\n        if (v < 1) {\r\n            $.removeAtt(input, 'size');\r\n        } else {\r\n            $.att(input, {size: v});\r\n        }\r\n    });\r\n    DB.propString(this, 'label')(function(v) {\r\n        if (v === null || (typeof v === 'string' && v.trim() == '')) {\r\n            $.addClass(elem, 'no-label');\r\n        } else {\r\n            $.removeClass(elem, 'no-label');\r\n            $.textOrHtml(label, v);\r\n            if (v.substr(0, 6) == '<html>') {\r\n                $.att(label, {title: ''});\r\n            } else {\r\n                $.att(label, {title: v});\r\n            }\r\n        }\r\n    });\r\n    DB.propString(this, 'placeholder')(function(v) {\r\n        $.att(input, {placeholder: v});\r\n    });\r\n    DB.propString(this, 'width')(function(v) {\r\n        elem.style.width = v;\r\n    });\r\n    DB.propInteger(this, 'action', '');\r\n\r\n    opts = DB.extend({\r\n        value: '',\r\n        type: 'text',\r\n        placeholder: '',\r\n        enabled: true,\r\n        validator: null,\r\n        valid: true,\r\n        list: null,\r\n        label: null,\r\n        placeholder: '',\r\n        size: 10,\r\n        width: 'auto',\r\n        wide: false,\r\n        visible: true\r\n    }, opts, this);\r\n\r\n    var complete = function() {\r\n        $.removeClass( elem, \"list\" );\r\n        if (!that.list || that.list.length == 0) return;\r\n\r\n        $.clear( datalist );\r\n        var list = that.list.slice();\r\n        \r\n        list.forEach(function (item) {\r\n            var div = $.div();\r\n            div.innerHTML = item;\r\n            $.add( datalist, div );\r\n            $.on( div, {\r\n                'down': function() {\r\n                    that.value = div.textContent.trim();\r\n                }\r\n            });\r\n        });\r\n        \r\n        $.addClass( elem, \"list\" );\r\n    };\r\n\r\n    var actionUpdateValue = LaterAction(function() {\r\n        that.value = input.value;\r\n    }, 300);\r\n    input.addEventListener('keyup', actionUpdateValue.fire.bind( actionUpdateValue ));\r\n    input.addEventListener('blur', function() {\r\n        that.value = input.value;\r\n        $.removeClass( elem, \"list\" );\r\n    });\r\n    input.addEventListener('focus', that.selectAll.bind(that));\r\n    input.addEventListener('keydown', function(evt) {\r\n        complete();\r\n        if (evt.keyCode == 13) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            if (that.valid !== false) {\r\n                DB.fire( that, 'value', input.value );\r\n                DB.fire( that, 'action', input.value );\r\n            }\r\n        }\r\n    });\r\n\r\n    this.validate();\r\n};\r\n\r\n\r\n/**\r\n * Force value validation.\r\n */\r\nText.prototype.validate = function() {\r\n    var validator = this.validator;\r\n    if (!validator) return;\r\n    try {\r\n        this.valid = validator( this.value );\r\n    }\r\n    catch (ex) {\r\n        console.error(\"[wdg.text:validate] Exception = \", ex);\r\n        console.error(\"[wdg.text:validate] Validator = \", validator);\r\n    }\r\n};\r\n\r\n/**\r\n * Select whole text.\r\n * @return {this}\r\n */\r\nText.prototype.selectAll = function() {\r\n    var e = this._input;\r\n    e.setSelectionRange(0, e.value.length);\r\n    return true;\r\n};\r\n\r\nmodule.exports = Text;\r\n\r\n\r\n\r\n \r\n});"],"names":["require","exports","module","$","DB","LaterAction","laterAction","Text","opts","that","this","label","div","input","tag","datalist","_input","elem","propString","v","value","validate","propEnum","att","type","propStringArray","clear","removeClass","Array","isArray","forEach","item","add","propValidator","bind","propBoolean","validator","addClass","removeAtt","disabled","propInteger","size","trim","textOrHtml","substr","title","placeholder","style","width","extend","enabled","valid","list","wide","visible","complete","length","slice","innerHTML","on","down","textContent","actionUpdateValue","addEventListener","fire","selectAll","evt","keyCode","preventDefault","stopPropagation","prototype","ex","console","error","e","setSelectionRange"],"mappings":"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"},"dependencies":["mod/dom","mod/tfw.data-binding","mod/tfw.timer","mod/wdg.text"]}