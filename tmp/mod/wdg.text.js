{"intl":"","src":"/** @module wdg.text */require( 'wdg.text', function(exports, module) {  var $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar LaterAction = require(\"tfw.timer\").laterAction;\r\n\r\n\r\n/**\r\n * @class tfw.edit.text\r\n * @description  HTML5 text input with many options.\r\n *\r\n * __Attributes__:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n */\r\nvar Text = function(opts) {\r\n    var that = this;\r\n\r\n    var label = $.div( 'label' );\r\n    var input = $.tag( \"input\" );\r\n    this._input = input;\r\n    var elem = $.elem( this, 'div', 'wdg-text', [label, input] );\r\n\r\n    DB.propString(this, 'value')(function(v) {\r\n        input.value = v;\r\n    });\r\n    DB.propString(this, 'type')(function(v) {\r\n        $.att(input, {type: v});\r\n    });\r\n    DB.propBoolean(this, 'enabled')(function(v) {\r\n        if (v) {\r\n            $.removeAtt(input, 'disabled');\r\n        } else {\r\n            $.att(input, {disabled: v});\r\n        }\r\n    });\r\n    DB.propString(this, 'label')(function(v) {\r\n        if (v === null) {\r\n            $.addClass(elem, 'no-label');\r\n        } else {\r\n            $.removeClass(elem, 'no-label');\r\n            $.textOrHtml(label, v);\r\n            if (v.substr(0, 6) == '<html>') {\r\n                $.att(label, {title: ''});\r\n            } else {\r\n                $.att(label, {title: v});\r\n            }\r\n        }\r\n    });\r\n    DB.propString(this, 'placeholder')(function(v) {\r\n        $.att(input, {placeholder: v});\r\n    });\r\n    DB.propString(this, 'width')(function(v) {\r\n        elem.style.width = v;\r\n    });\r\n    DB.propInteger(this, 'action', 0);\r\n\r\n    opts = DB.extend({\r\n        value: '',\r\n        type: 'text',\r\n        enabled: true,\r\n        label: null,\r\n        placeholder: '',\r\n        width: '140px',\r\n        wide: false,\r\n        visible: true\r\n    }, opts, this);\r\n\r\n    var actionUpdateValue = LaterAction(function() {\r\n        that.value = input.value;\r\n    }, 300);\r\n    input.addEventListener('keydown', function(evt) {\r\n        if (evt.keyCode == 13) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            that.action++;\r\n        }\r\n    });\r\n    input.addEventListener('keyup', actionUpdateValue.fire.bind( actionUpdateValue ));\r\n    input.addEventListener('focus', that.selectAll.bind(that));\r\n};\r\n\r\n\r\n/**\r\n * Force value validation.\r\n */\r\nText.prototype.validate = function() {\r\n    var opts = this._opts;\r\n    if (typeof opts.validator !== 'function') return this;\r\n    var onValid = opts.onValid;\r\n    try {\r\n        if (opts.validator(this.val())) {\r\n            this._valid = 1;\r\n            this._input.removeClass(\"not-valid\").addClass(\"valid\");\r\n            if (onValid) onValid(true, this);\r\n        } else {\r\n            this._valid = -1;\r\n            this._input.removeClass(\"valid\").addClass(\"not-valid\");\r\n            if (onValid) onValid(false, this);\r\n        }\r\n    }\r\n    catch (ex) {\r\n        console.error(\"[tp4.input] Validation error: \", ex);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Select whole text.\r\n * @return {this}\r\n */\r\nText.prototype.selectAll = function() {\r\n    var e = this._input;\r\n    e.setSelectionRange(0, e.value.length);\r\n    return true;\r\n};\r\n\r\nmodule.exports = Text;\r\n\r\n\r\n\r\n \r\n/**\n * @module wdg.text\n * @see module:dom\n * @see module:tfw.data-binding\n * @see module:tfw.timer\n * @see module:wdg.text\n\n */\n});","zip":"require(\"wdg.text\",function(t,e){var i=require(\"dom\"),n=require(\"tfw.data-binding\"),a=require(\"tfw.timer\").laterAction,l=function(t){var e=this,l=i.div(\"label\"),r=i.tag(\"input\");this._input=r;var o=i.elem(this,\"div\",\"wdg-text\",[l,r]);n.propString(this,\"value\")(function(t){r.value=t}),n.propString(this,\"type\")(function(t){i.att(r,{type:t})}),n.propBoolean(this,\"enabled\")(function(t){t?i.removeAtt(r,\"disabled\"):i.att(r,{disabled:t})}),n.propString(this,\"label\")(function(t){null===t?i.addClass(o,\"no-label\"):(i.removeClass(o,\"no-label\"),i.textOrHtml(l,t),\"<html>\"==t.substr(0,6)?i.att(l,{title:\"\"}):i.att(l,{title:t}))}),n.propString(this,\"placeholder\")(function(t){i.att(r,{placeholder:t})}),n.propString(this,\"width\")(function(t){o.style.width=t}),n.propInteger(this,\"action\",0),t=n.extend({value:\"\",type:\"text\",enabled:!0,label:null,placeholder:\"\",width:\"140px\",wide:!1,visible:!0},t,this);var s=a(function(){e.value=r.value},300);r.addEventListener(\"keydown\",function(t){13==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.action++)}),r.addEventListener(\"keyup\",s.fire.bind(s)),r.addEventListener(\"focus\",e.selectAll.bind(e))};l.prototype.validate=function(){var t=this._opts;if(\"function\"!=typeof t.validator)return this;var e=t.onValid;try{t.validator(this.val())?(this._valid=1,this._input.removeClass(\"not-valid\").addClass(\"valid\"),e&&e(!0,this)):(this._valid=-1,this._input.removeClass(\"valid\").addClass(\"not-valid\"),e&&e(!1,this))}catch(i){console.error(\"[tp4.input] Validation error: \",i)}return this},l.prototype.selectAll=function(){var t=this._input;return t.setSelectionRange(0,t.value.length),!0},e.exports=l});\n//# sourceMappingURL=wdg.text.js.map","map":{"version":3,"file":"wdg.text.js.map","sources":["wdg.text.js"],"sourcesContent":["/** @module wdg.text */require( 'wdg.text', function(exports, module) {  var $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar LaterAction = require(\"tfw.timer\").laterAction;\r\n\r\n\r\n/**\r\n * @class tfw.edit.text\r\n * @description  HTML5 text input with many options.\r\n *\r\n * __Attributes__:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n * * {string} `value`:\r\n */\r\nvar Text = function(opts) {\r\n    var that = this;\r\n\r\n    var label = $.div( 'label' );\r\n    var input = $.tag( \"input\" );\r\n    this._input = input;\r\n    var elem = $.elem( this, 'div', 'wdg-text', [label, input] );\r\n\r\n    DB.propString(this, 'value')(function(v) {\r\n        input.value = v;\r\n    });\r\n    DB.propString(this, 'type')(function(v) {\r\n        $.att(input, {type: v});\r\n    });\r\n    DB.propBoolean(this, 'enabled')(function(v) {\r\n        if (v) {\r\n            $.removeAtt(input, 'disabled');\r\n        } else {\r\n            $.att(input, {disabled: v});\r\n        }\r\n    });\r\n    DB.propString(this, 'label')(function(v) {\r\n        if (v === null) {\r\n            $.addClass(elem, 'no-label');\r\n        } else {\r\n            $.removeClass(elem, 'no-label');\r\n            $.textOrHtml(label, v);\r\n            if (v.substr(0, 6) == '<html>') {\r\n                $.att(label, {title: ''});\r\n            } else {\r\n                $.att(label, {title: v});\r\n            }\r\n        }\r\n    });\r\n    DB.propString(this, 'placeholder')(function(v) {\r\n        $.att(input, {placeholder: v});\r\n    });\r\n    DB.propString(this, 'width')(function(v) {\r\n        elem.style.width = v;\r\n    });\r\n    DB.propInteger(this, 'action', 0);\r\n\r\n    opts = DB.extend({\r\n        value: '',\r\n        type: 'text',\r\n        enabled: true,\r\n        label: null,\r\n        placeholder: '',\r\n        width: '140px',\r\n        wide: false,\r\n        visible: true\r\n    }, opts, this);\r\n\r\n    var actionUpdateValue = LaterAction(function() {\r\n        that.value = input.value;\r\n    }, 300);\r\n    input.addEventListener('keydown', function(evt) {\r\n        if (evt.keyCode == 13) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            that.action++;\r\n        }\r\n    });\r\n    input.addEventListener('keyup', actionUpdateValue.fire.bind( actionUpdateValue ));\r\n    input.addEventListener('focus', that.selectAll.bind(that));\r\n};\r\n\r\n\r\n/**\r\n * Force value validation.\r\n */\r\nText.prototype.validate = function() {\r\n    var opts = this._opts;\r\n    if (typeof opts.validator !== 'function') return this;\r\n    var onValid = opts.onValid;\r\n    try {\r\n        if (opts.validator(this.val())) {\r\n            this._valid = 1;\r\n            this._input.removeClass(\"not-valid\").addClass(\"valid\");\r\n            if (onValid) onValid(true, this);\r\n        } else {\r\n            this._valid = -1;\r\n            this._input.removeClass(\"valid\").addClass(\"not-valid\");\r\n            if (onValid) onValid(false, this);\r\n        }\r\n    }\r\n    catch (ex) {\r\n        console.error(\"[tp4.input] Validation error: \", ex);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Select whole text.\r\n * @return {this}\r\n */\r\nText.prototype.selectAll = function() {\r\n    var e = this._input;\r\n    e.setSelectionRange(0, e.value.length);\r\n    return true;\r\n};\r\n\r\nmodule.exports = Text;\r\n\r\n\r\n\r\n \r\n});"],"names":["require","exports","module","$","DB","LaterAction","laterAction","Text","opts","that","this","label","div","input","tag","_input","elem","propString","v","value","att","type","propBoolean","removeAtt","disabled","addClass","removeClass","textOrHtml","substr","title","placeholder","style","width","propInteger","extend","enabled","wide","visible","actionUpdateValue","addEventListener","evt","keyCode","preventDefault","stopPropagation","action","fire","bind","selectAll","prototype","validate","_opts","validator","onValid","val","_valid","ex","console","error","e","setSelectionRange","length"],"mappings":"AAAuBA,QAAS,WAAY,SAASC,EAASC,GAAW,GAAIC,GAAIH,QAAQ,OACrFI,EAAKJ,QAAQ,oBACbK,EAAcL,QAAQ,aAAaM,YAgBnCC,EAAO,SAASC,GAChB,GAAIC,GAAOC,KAEPC,EAAQR,EAAES,IAAK,SACfC,EAAQV,EAAEW,IAAK,QACnBJ,MAAKK,OAASF,CACd,IAAIG,GAAOb,EAAEa,KAAMN,KAAM,MAAO,YAAaC,EAAOE,GAEpDT,GAAGa,WAAWP,KAAM,SAAS,SAASQ,GAClCL,EAAMM,MAAQD,IAElBd,EAAGa,WAAWP,KAAM,QAAQ,SAASQ,GACjCf,EAAEiB,IAAIP,GAAQQ,KAAMH,MAExBd,EAAGkB,YAAYZ,KAAM,WAAW,SAASQ,GACjCA,EACAf,EAAEoB,UAAUV,EAAO,YAEnBV,EAAEiB,IAAIP,GAAQW,SAAUN,MAGhCd,EAAGa,WAAWP,KAAM,SAAS,SAASQ,GACxB,OAANA,EACAf,EAAEsB,SAAST,EAAM,aAEjBb,EAAEuB,YAAYV,EAAM,YACpBb,EAAEwB,WAAWhB,EAAOO,GACE,UAAlBA,EAAEU,OAAO,EAAG,GACZzB,EAAEiB,IAAIT,GAAQkB,MAAO,KAErB1B,EAAEiB,IAAIT,GAAQkB,MAAOX,OAIjCd,EAAGa,WAAWP,KAAM,eAAe,SAASQ,GACxCf,EAAEiB,IAAIP,GAAQiB,YAAaZ,MAE/Bd,EAAGa,WAAWP,KAAM,SAAS,SAASQ,GAClCF,EAAKe,MAAMC,MAAQd,IAEvBd,EAAG6B,YAAYvB,KAAM,SAAU,GAE/BF,EAAOJ,EAAG8B,QACNf,MAAO,GACPE,KAAM,OACNc,SAAS,EACTxB,MAAO,KACPmB,YAAa,GACbE,MAAO,QACPI,MAAM,EACNC,SAAS,GACV7B,EAAME,KAET,IAAI4B,GAAoBjC,EAAY,WAChCI,EAAKU,MAAQN,EAAMM,OACpB,IACHN,GAAM0B,iBAAiB,UAAW,SAASC,GACpB,IAAfA,EAAIC,UACJD,EAAIE,iBACJF,EAAIG,kBACJlC,EAAKmC,YAGb/B,EAAM0B,iBAAiB,QAASD,EAAkBO,KAAKC,KAAMR,IAC7DzB,EAAM0B,iBAAiB,QAAS9B,EAAKsC,UAAUD,KAAKrC,IAOxDF,GAAKyC,UAAUC,SAAW,WACtB,GAAIzC,GAAOE,KAAKwC,KAChB,IAA8B,kBAAnB1C,GAAK2C,UAA0B,MAAOzC,KACjD,IAAI0C,GAAU5C,EAAK4C,OACnB,KACQ5C,EAAK2C,UAAUzC,KAAK2C,QACpB3C,KAAK4C,OAAS,EACd5C,KAAKK,OAAOW,YAAY,aAAaD,SAAS,SAC1C2B,GAASA,GAAQ,EAAM1C,QAE3BA,KAAK4C,OAAS,GACd5C,KAAKK,OAAOW,YAAY,SAASD,SAAS,aACtC2B,GAASA,GAAQ,EAAO1C,OAGpC,MAAO6C,GACHC,QAAQC,MAAM,iCAAkCF,GAEpD,MAAO7C,OAOXH,EAAKyC,UAAUD,UAAY,WACvB,GAAIW,GAAIhD,KAAKK,MAEb,OADA2C,GAAEC,kBAAkB,EAAGD,EAAEvC,MAAMyC,SACxB,GAGX1D,EAAOD,QAAUM"},"dependencies":["mod/dom","mod/tfw.data-binding","mod/tfw.timer","mod/wdg.text"]}