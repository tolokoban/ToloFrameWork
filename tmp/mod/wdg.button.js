{"intl":"","src":"/** @module wdg.button */require( 'wdg.button', function(exports, module) {  var $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar Icon = require(\"wdg.icon\");\r\n\r\nvar TYPES = ['standard', 'simple', 'warning', 'shadow', 'special'];\r\n\r\n/**\r\n * Liste des classes CSS applicables sur un bouton :\r\n * * __simple__ : Simple lien, sans l'aspect \"bouton\".\r\n * * __shadow__ : Bouton légèrement plus foncé.\r\n * * __warning__ : Bouton orangé pour indiquer une action potentiellement dangereuse.\r\n * * __small__ : Bouton de petite taille (environ 70%).\r\n *\r\n * @param {object} opts\r\n * * {string} `value`: Text à afficher dans le bouton.\r\n * * {string} `href`: Si défini, lien vers lequel dirigier la page en cas de click.\r\n * * {boolean} `enabled`: Mettre `false` pour désactiver le bouton.\r\n * * {object} `email`: Associe le _Tap_ à l'envoi d'un mail.\r\n *   * {string} `to`: destinataire.\r\n *   * {string} `subject`: sujet du mail.\r\n *   * {string} `body`: corps du mail.\r\n *\r\n * @example\r\n * var Button = require(\"tp4.button\");\r\n * var instance = new Button();\r\n * @class Button\r\n */\r\nvar Button = function(opts) {\r\n    var that = this;\r\n\r\n    var elem = $.elem(this, typeof opts.href === 'string' ? 'a' : 'button', 'wdg-button');\r\n    var icon = null;\r\n\r\n    var refresh = function() {\r\n        $.clear( elem );\r\n        if (icon) {\r\n            $.add( elem, icon.element, that.text );\r\n        } else {\r\n            elem.textContent = that.text;\r\n        }        \r\n    };\r\n    \r\n    DB.prop(this, 'value');\r\n    DB.propEnum( TYPES )(this, 'type')(function(v) {\r\n        TYPES.forEach(function (type) {\r\n            $.removeClass(elem, type);\r\n        });\r\n        $.addClass(elem, v);\r\n    });\r\n    DB.prop(this, 'icon')(function(v) {\r\n        if (!v || (typeof v === 'string' && v.trim().length == 0)) {\r\n            icon = null;\r\n        } else if (v.element) {\r\n            icon = v.element;\r\n        } else {\r\n            icon = new Icon({content: v, size: \"1.2em\"});\r\n        }\r\n        refresh();\r\n    });\r\n    DB.propString(this, 'text')(function(v) {\r\n        refresh();\r\n    });\r\n    DB.propBoolean(this, 'enabled')(function(v) {\r\n        if (v) {\r\n            $.removeAtt(elem, 'disabled');\r\n        } else {\r\n            $.att(elem, 'disabled', 'yes');\r\n        }\r\n    });\r\n    DB.propBoolean(this, 'small')(function(v) {\r\n        if (v) {\r\n            $.addClass(elem, 'small');\r\n        } else {\r\n            $.removeClass(elem, 'small');\r\n        }\r\n    });\r\n    DB.prop(this, 'action', 0);\r\n\r\n    opts = DB.extend({\r\n        text: \"OK\",\r\n        value: \"action\",\r\n        icon: \"\",\r\n        small: false,\r\n        enabled: true,\r\n        wide: false,\r\n        visible: true,\r\n        type: \"standard\"\r\n    }, opts, this);\r\n\r\n    // Animate the pressing.\r\n    $.on(this.element, {\r\n        down: function() {\r\n            if (that.enabled) {\r\n                $.addClass(elem, 'press');\r\n            }\r\n        },\r\n        up: function() {\r\n            $.removeClass(elem, 'press');\r\n        },\r\n        tap: that.fire.bind( that ),\r\n        keydown: function(evt) {\r\n            if (evt.keyCode == 13 || evt.keyCode == 32) {\r\n                evt.preventDefault();\r\n                evt.stopPropagation();\r\n                that.fire();\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Simulate a click on the button if it is enabled.\r\n */\r\nButton.prototype.fire = function() {\r\n    if (this.enabled) DB.fire( this, 'action', this.value );\r\n};\r\n\r\n/**\r\n * Disable the button and start a wait animation.\r\n */\r\nButton.prototype.waitOn = function(text) {\r\n    if (typeof text === 'undefined') text = this.caption();\r\n    this.enabled(false);\r\n    this.clear(W({size: '1em', caption: text}));\r\n};\r\n\r\n/**\r\n * Stop the wait animation and enable the button again.\r\n */\r\nButton.prototype.waitOff = function() {\r\n    this.caption(this.caption());\r\n    this.enabled(true);\r\n};\r\n\r\n\r\nfunction genericButton( id, classes, defaults ) {\r\n    var btn = new Button({ caption: _(id) });\r\n    if ( classes.length > 0 ) {\r\n        var i, cls;\r\n        for (i = 0 ; i < classes.length ; i++) {\r\n            cls = classes[i];\r\n            btn.addClass( cls );\r\n        }\r\n    } else {\r\n        if (typeof defaults === 'undefined') return btn;\r\n        if (!Array.isArray(defaults)) {\r\n            defaults = [defaults];\r\n        }\r\n        defaults.forEach(function (cls) {\r\n            btn.addClass( cls );\r\n        });\r\n    }\r\n    return btn;\r\n}\r\n\r\nButton.Cancel = function() { return genericButton('cancel', arguments); };\r\nButton.Close = function() { return genericButton('close', arguments, 'simple'); };\r\nButton.Delete = function() { return genericButton('delete', arguments, 'warning'); };\r\nButton.No = function() { return genericButton('no', arguments); };\r\nButton.Ok = function() { return genericButton('ok', arguments); };\r\nButton.Edit = function() { return genericButton('edit', arguments); };\r\nButton.Save = function() { return genericButton('save', arguments, 'warning'); };\r\nButton.Yes = function() { return genericButton('yes', arguments); };\r\n\r\nButton.default = {\r\n    caption: \"OK\",\r\n    type: \"default\"\r\n};\r\n\r\nmodule.exports = Button;\r\n\r\n\r\n\r\n \r\n/**\n * @module wdg.button\n * @see module:dom\n * @see module:tfw.data-binding\n * @see module:wdg.button\n * @see module:wdg.icon\n\n */\n});","zip":"require(\"wdg.button\",function(e,t){function n(e,t,n){var i=new s({caption:_(e)});if(t.length>0){var o,a;for(o=0;o<t.length;o++)a=t[o],i.addClass(a)}else{if(\"undefined\"==typeof n)return i;Array.isArray(n)||(n=[n]),n.forEach(function(e){i.addClass(e)})}return i}var i=require(\"dom\"),o=require(\"tfw.data-binding\"),a=require(\"wdg.icon\"),r=[\"standard\",\"simple\",\"warning\",\"shadow\",\"special\"],s=function(e){var t=this,n=i.elem(this,\"string\"==typeof e.href?\"a\":\"button\",\"wdg-button\"),s=null,l=function(){i.clear(n),s?i.add(n,s.element,t.text):n.textContent=t.text};o.prop(this,\"value\"),o.propEnum(r)(this,\"type\")(function(e){r.forEach(function(e){i.removeClass(n,e)}),i.addClass(n,e)}),o.prop(this,\"icon\")(function(e){s=!e||\"string\"==typeof e&&0==e.trim().length?null:e.element?e.element:new a({content:e,size:\"1.2em\"}),l()}),o.propString(this,\"text\")(function(e){l()}),o.propBoolean(this,\"enabled\")(function(e){e?i.removeAtt(n,\"disabled\"):i.att(n,\"disabled\",\"yes\")}),o.propBoolean(this,\"small\")(function(e){e?i.addClass(n,\"small\"):i.removeClass(n,\"small\")}),o.prop(this,\"action\",0),e=o.extend({text:\"OK\",value:\"action\",icon:\"\",small:!1,enabled:!0,wide:!1,visible:!0,type:\"standard\"},e,this),i.on(this.element,{down:function(){t.enabled&&i.addClass(n,\"press\")},up:function(){i.removeClass(n,\"press\")},tap:t.fire.bind(t),keydown:function(e){13!=e.keyCode&&32!=e.keyCode||(e.preventDefault(),e.stopPropagation(),t.fire())}})};s.prototype.fire=function(){this.enabled&&o.fire(this,\"action\",this.value)},s.prototype.waitOn=function(e){\"undefined\"==typeof e&&(e=this.caption()),this.enabled(!1),this.clear(W({size:\"1em\",caption:e}))},s.prototype.waitOff=function(){this.caption(this.caption()),this.enabled(!0)},s.Cancel=function(){return n(\"cancel\",arguments)},s.Close=function(){return n(\"close\",arguments,\"simple\")},s.Delete=function(){return n(\"delete\",arguments,\"warning\")},s.No=function(){return n(\"no\",arguments)},s.Ok=function(){return n(\"ok\",arguments)},s.Edit=function(){return n(\"edit\",arguments)},s.Save=function(){return n(\"save\",arguments,\"warning\")},s.Yes=function(){return n(\"yes\",arguments)},s[\"default\"]={caption:\"OK\",type:\"default\"},t.exports=s});\n//# sourceMappingURL=wdg.button.js.map","map":{"version":3,"file":"wdg.button.js.map","sources":["wdg.button.js"],"sourcesContent":["/** @module wdg.button */require( 'wdg.button', function(exports, module) {  var $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar Icon = require(\"wdg.icon\");\r\n\r\nvar TYPES = ['standard', 'simple', 'warning', 'shadow', 'special'];\r\n\r\n/**\r\n * Liste des classes CSS applicables sur un bouton :\r\n * * __simple__ : Simple lien, sans l'aspect \"bouton\".\r\n * * __shadow__ : Bouton légèrement plus foncé.\r\n * * __warning__ : Bouton orangé pour indiquer une action potentiellement dangereuse.\r\n * * __small__ : Bouton de petite taille (environ 70%).\r\n *\r\n * @param {object} opts\r\n * * {string} `value`: Text à afficher dans le bouton.\r\n * * {string} `href`: Si défini, lien vers lequel dirigier la page en cas de click.\r\n * * {boolean} `enabled`: Mettre `false` pour désactiver le bouton.\r\n * * {object} `email`: Associe le _Tap_ à l'envoi d'un mail.\r\n *   * {string} `to`: destinataire.\r\n *   * {string} `subject`: sujet du mail.\r\n *   * {string} `body`: corps du mail.\r\n *\r\n * @example\r\n * var Button = require(\"tp4.button\");\r\n * var instance = new Button();\r\n * @class Button\r\n */\r\nvar Button = function(opts) {\r\n    var that = this;\r\n\r\n    var elem = $.elem(this, typeof opts.href === 'string' ? 'a' : 'button', 'wdg-button');\r\n    var icon = null;\r\n\r\n    var refresh = function() {\r\n        $.clear( elem );\r\n        if (icon) {\r\n            $.add( elem, icon.element, that.text );\r\n        } else {\r\n            elem.textContent = that.text;\r\n        }        \r\n    };\r\n    \r\n    DB.prop(this, 'value');\r\n    DB.propEnum( TYPES )(this, 'type')(function(v) {\r\n        TYPES.forEach(function (type) {\r\n            $.removeClass(elem, type);\r\n        });\r\n        $.addClass(elem, v);\r\n    });\r\n    DB.prop(this, 'icon')(function(v) {\r\n        if (!v || (typeof v === 'string' && v.trim().length == 0)) {\r\n            icon = null;\r\n        } else if (v.element) {\r\n            icon = v.element;\r\n        } else {\r\n            icon = new Icon({content: v, size: \"1.2em\"});\r\n        }\r\n        refresh();\r\n    });\r\n    DB.propString(this, 'text')(function(v) {\r\n        refresh();\r\n    });\r\n    DB.propBoolean(this, 'enabled')(function(v) {\r\n        if (v) {\r\n            $.removeAtt(elem, 'disabled');\r\n        } else {\r\n            $.att(elem, 'disabled', 'yes');\r\n        }\r\n    });\r\n    DB.propBoolean(this, 'small')(function(v) {\r\n        if (v) {\r\n            $.addClass(elem, 'small');\r\n        } else {\r\n            $.removeClass(elem, 'small');\r\n        }\r\n    });\r\n    DB.prop(this, 'action', 0);\r\n\r\n    opts = DB.extend({\r\n        text: \"OK\",\r\n        value: \"action\",\r\n        icon: \"\",\r\n        small: false,\r\n        enabled: true,\r\n        wide: false,\r\n        visible: true,\r\n        type: \"standard\"\r\n    }, opts, this);\r\n\r\n    // Animate the pressing.\r\n    $.on(this.element, {\r\n        down: function() {\r\n            if (that.enabled) {\r\n                $.addClass(elem, 'press');\r\n            }\r\n        },\r\n        up: function() {\r\n            $.removeClass(elem, 'press');\r\n        },\r\n        tap: that.fire.bind( that ),\r\n        keydown: function(evt) {\r\n            if (evt.keyCode == 13 || evt.keyCode == 32) {\r\n                evt.preventDefault();\r\n                evt.stopPropagation();\r\n                that.fire();\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * Simulate a click on the button if it is enabled.\r\n */\r\nButton.prototype.fire = function() {\r\n    if (this.enabled) DB.fire( this, 'action', this.value );\r\n};\r\n\r\n/**\r\n * Disable the button and start a wait animation.\r\n */\r\nButton.prototype.waitOn = function(text) {\r\n    if (typeof text === 'undefined') text = this.caption();\r\n    this.enabled(false);\r\n    this.clear(W({size: '1em', caption: text}));\r\n};\r\n\r\n/**\r\n * Stop the wait animation and enable the button again.\r\n */\r\nButton.prototype.waitOff = function() {\r\n    this.caption(this.caption());\r\n    this.enabled(true);\r\n};\r\n\r\n\r\nfunction genericButton( id, classes, defaults ) {\r\n    var btn = new Button({ caption: _(id) });\r\n    if ( classes.length > 0 ) {\r\n        var i, cls;\r\n        for (i = 0 ; i < classes.length ; i++) {\r\n            cls = classes[i];\r\n            btn.addClass( cls );\r\n        }\r\n    } else {\r\n        if (typeof defaults === 'undefined') return btn;\r\n        if (!Array.isArray(defaults)) {\r\n            defaults = [defaults];\r\n        }\r\n        defaults.forEach(function (cls) {\r\n            btn.addClass( cls );\r\n        });\r\n    }\r\n    return btn;\r\n}\r\n\r\nButton.Cancel = function() { return genericButton('cancel', arguments); };\r\nButton.Close = function() { return genericButton('close', arguments, 'simple'); };\r\nButton.Delete = function() { return genericButton('delete', arguments, 'warning'); };\r\nButton.No = function() { return genericButton('no', arguments); };\r\nButton.Ok = function() { return genericButton('ok', arguments); };\r\nButton.Edit = function() { return genericButton('edit', arguments); };\r\nButton.Save = function() { return genericButton('save', arguments, 'warning'); };\r\nButton.Yes = function() { return genericButton('yes', arguments); };\r\n\r\nButton.default = {\r\n    caption: \"OK\",\r\n    type: \"default\"\r\n};\r\n\r\nmodule.exports = Button;\r\n\r\n\r\n\r\n \r\n});"],"names":["require","exports","module","genericButton","id","classes","defaults","btn","Button","caption","_","length","i","cls","addClass","Array","isArray","forEach","$","DB","Icon","TYPES","opts","that","this","elem","href","icon","refresh","clear","add","element","text","textContent","prop","propEnum","v","type","removeClass","trim","content","size","propString","propBoolean","removeAtt","att","extend","value","small","enabled","wide","visible","on","down","up","tap","fire","bind","keydown","evt","keyCode","preventDefault","stopPropagation","prototype","waitOn","W","waitOff","Cancel","arguments","Close","Delete","No","Ok","Edit","Save","Yes"],"mappings":"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"},"dependencies":["mod/dom","mod/tfw.data-binding","mod/wdg.button","mod/wdg.icon"]}