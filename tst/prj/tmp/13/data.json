{"needs":[],"includes":[],"timestamp":0,"tags":{"def":{"needs":[],"functions":{},"comment":"*\n * ToloFrameWork v3.0.1\n *-------------------------------------------------------------------------------\n *  ### To define a class (let's call it MyClass), use this syntax:\n * \n *  window[\"TFW::MyClass\"] = {\n *  singleton: false,\n *  superclass: \"...\",\n *  signals: [...],\n *  attributes: {...},\n *  classInit: function(staticVars) {...},\n *  lang: {\n *  en: {...},\n *  fr: {...},\n *  ...\n *  },\n *  init: function() {},\n *  functions: {\n *  foo: function(...) {...},\n *  bar: function(...) {...},\n *  ...\n *  }\n *  }\n * \n * \n *  ### To create an instance of MyClass:\n * \n *  var obj = $$(\"MyClass\");\n *  var obj = $$(\"MyClass\", {caption: \"Hello world!\"});\n * \n * \n *  ### Here are special functions that every class shares:\n * \n *  $id         [string]  : unique id referencing this object.\n *  $classname  [string]  : name of the current class.\n *  $parent     [object]  : prototype of the parent class if exist.\n *  $superclass [string]  : name of the superclass.\n *  $singleton  [boolean] : is this object a boolean?\n *  $statics    [object]  : map of the static variables shared by all instances of this class.\n "},"zip":"window.$$=function(){var t,n=0,e={},o={},r={},i=null,s=function(n){return void 0===n?(i||(i=t.localLoad(\"tfw3.Language\",null)||navigator.language||navigator.browserLanguage||\"en\"),i):(i=n,void t.localSave(\"tfw3.Language\",n))},a=function(t,n){t.prototype[\"fire\"+n]=function(t){this[\"$_\"+n].emit(t)},t.prototype[n]=function(t,e,o){return this[\"$_\"+n].connect(t,e,o),this},t.prototype[\"unbind\"+n]=function(t,e,o){return this[\"$_\"+n].disconnect(t,e,o),this}},f=function(){};f.prototype.$=function(t){var n,e,o,r,i,a,f=this.$lang[s()];if(f||(f=this.$lang[this.$defLang]),!f)return\"[[\"+t+\"]]\";if(n=f[t],!n)return\"[[\"+t+\"]]\";if(arguments.length>1){for(e=\"\",i=0,o=0;o<n.length;o++)r=n.charAt(o),\"$\"===r?(e+=n.substring(i,o),o++,a=n.charCodeAt(o)-48,e+=1>a||a>=arguments.length?\"$\"+n.charAt(o):arguments[a],i=o+1):\"\\\\\"===r&&(e+=n.substring(i,o),o++,e+=n.charAt(o),i=o+1);e+=n.substr(i),n=e}return n},f.prototype.$super=function(t){for(var n=window[this.$classname];n;){if(n.prototype.$classname==t)return n.prototype;if(n=n.prototype.$parent,!n)break;n=window[n.$classname]}return null},f.prototype.$classname=null,f.prototype.$parent=null;var u=function(t,n){this._name=n,this._sender=t,this._slots={}};u.prototype.connect=function(t,n,e){var o,r;return\"function\"==typeof t?(o=this._key(t),r=this._slots[o],void 0===r&&(r=[t,{}],this._slots[o]=r),r[1]={data:n,emitter:this._sender,signal:this._name}):(o=this._key(t,n),r=this._slots[o],void 0===r&&(r=[t[n],{},t],this._slots[o]=r),r[1]={data:e,emitter:this._sender,slot:n,signal:this._name}),o},u.prototype.disconnect=function(t,n){var e;e=\"function\"==typeof t?this._key(t):n?this._key(t,n):t,delete this._slots[e]},u.prototype.emit=function(t){var n,e,o,r,i,s;for(n in this._slots){if(e=this._slots[n])if(o=e[0],r=e[1],\"undefined\"==typeof r.emitter&&(r.emitter={}),i=e[2])try{s=o.call(i,t,r)}catch(a){throw console.log(\"data:\",r),console.error(\"arg:\",t),new Error(\"[\"+r.emitter.$classname+\".fire\"+r.signal+\"] Exception occured in slot \"+i.$classname+\".\"+r.slot+\"()\\n\"+a)}else try{s=o(t,r)}catch(a){throw console.log(\"data:\",r),console.error(\"arg:\",t),new Error(\"[\"+r.emitter.$classname+\".fire\"+r.signal+\"] Exception occured in anonymous slot\\n\"+a)}if(0===s)break}},u.prototype._key=function(t,n){\"undefined\"==typeof t.$id&&(t.$id=l());var e=\"\"+t.$id;return n&&(e+=n),e};var l=function(){return n++,n>2e9&&(n=0),n},c=function(t){var n=r[t];if(!n){var e,i,s=window[\"TFW::\"+t];if(!s)throw new Error('[TFW3] This class has not been defined: \"'+t+'\"!\\nDid you forget to include it?');n=function(){};var u=f;if(s.superclass&&(u=c(s.superclass)),n.prototype=new u,n.prototype.constructor=n,n.prototype.$parent=u.prototype,\"object\"==typeof s.lang){n.prototype.$lang=s.lang;for(e in s.lang){n.prototype.$defLang=e;break}}else n.prototype.$lang=u.prototype.$lang||{},n.prototype.$defLang=u.prototype.$defLang||\"en\";n.prototype.$superclass=u.prototype.$classname,n.prototype.$classname=t,n.prototype.$signals=s.signals,n.prototype.$singleton=s.singleton;var l={className:t};if(o[t]=l,n.prototype.$statics=l,s.attributes)for(e in s.attributes)n.prototype[\"_\"+e]=s.attributes[e];if(n.prototype.$init=s.init,s.signals)for(g in s.signals)a(n,s.signals[g]);for(i in s.functions)s.superclass&&n.prototype[i]&&(n.prototype[s.superclass+\"$\"+i]=n.prototype[i]),n.prototype[i]=s.functions[i];r[t]=n,\"function\"==typeof s.classInit&&s.classInit(l)}return n};if(t=function(t,n){var o,r,i,s,a,f,p,g,d,y,$,h,w;if(o=e[t],o&&\"object\"==typeof o)return o;if(r=c(t),i=new r,i.$id=l(),\"object\"==typeof n)for(s in n)s&&(i[\"_\"+s]=n[s]);for(a=[],f=[],p={},g=r.prototype;g;){if(g.$signals)for(d in g.$signals)p[g.$signals[d]]=1;y=g.$init,y&&y!=a[a.length-1]&&(a.push(y),f.push(g.$classname)),g=g.$parent}for($ in p)$&&(w=new u(i,$),i[\"$_\"+$]=w);for(;a.length>0;)y=a.pop(),h=f.pop(),y&&y.call(i);return i.$singleton&&(e[t]=i),i},t.App={},t.lang=s,t.statics=function(t){return t in o?o[t]:void 0},t.extend=function(t,n,e){var o;if(void 0===t&&(t={}),n)for(o in n)void 0!==o&&(e&&void 0===t[o]||(t[o]=n[o]));return t},t.clone=function(t){var n,e,o;if($$.isArray(t)){n=[];for(o in t)n.push($$.clone(t[o]));return n}if(\"object\"==typeof t){n={};for(e in t)n[e]=$$.clone(t[e]);return n}return t},void 0===String.prototype.trim&&($$._trimLeft=new RegExp(\"^\\\\s+\"),$$._trimRight=new RegExp(\"\\\\s+$\"),String.prototype.trim=function(){return this.toString().replace($$._trimLeft,\"\").replace($$._trimRight,\"\")}),\"undefined\"==typeof window.JSON&&(window.JSON={}),\"undefined\"==typeof window.JSON.parse&&(window.JSON.parse=function(t){try{return\"string\"==typeof t&&t?(t=t.trim(),new Function(\"return \"+t)()):null}catch(n){throw new Error(\"Invalid JSON!\\n\"+n+\"\\n\"+t)}}),\"undefined\"==typeof window.JSON.stringify){var p=function(t){var n=/[\"\\\\\\x00-\\x1f\\x7f-\\x9f]/g,e={\"\\b\":\"\\\\b\",\"\t\":\"\\\\t\",\"\\n\":\"\\\\n\",\"\\f\":\"\\\\f\",\"\\r\":\"\\\\r\",'\"':'\\\\\"',\"\\\\\":\"\\\\\\\\\"};return t.match(n)?'\"'+t.replace(n,function(t){var n=e[t];return\"string\"==typeof n?n:(n=t.charCodeAt(),\"\\\\u00\"+Math.floor(n/16).toString(16)+(n%16).toString(16))})+'\"':'\"'+t+'\"'};window.JSON.stringify=function(t){var n,e,o,r,i,s,a,f,u,l,c,g,d,y=typeof t;if(null===t||\"undefined\"==y)return\"null\";if(\"number\"==y||\"boolean\"==y)return t+\"\";if(\"string\"==y)return p(t);if(\"object\"==y){if(\"function\"==typeof t.toJSON)return JSON.stringify(t.toJSON());if(t.constructor===Date)return n=t.getUTCMonth()+1,10>n&&(n=\"0\"+n),e=t.getUTCDate(),10>e&&(e=\"0\"+e),o=t.getUTCFullYear(),r=t.getUTCHours(),10>r&&(r=\"0\"+r),i=t.getUTCMinutes(),10>i&&(i=\"0\"+i),s=t.getUTCSeconds(),10>s&&(s=\"0\"+s),a=t.getUTCMilliseconds(),100>a&&(a=\"0\"+a),10>a&&(a=\"0\"+a),'\"'+o+\"-\"+n+\"-\"+e+\"T\"+r+\":\"+i+\":\"+s+\".\"+a+'Z\"';if(t.constructor===Array){for(f=[],u=0;u<t.length;u++)f.push(JSON.stringify(t[u])||\"null\");return\"[\"+f.join(\",\")+\"]\"}l=[];for(c in t){if(y=typeof c,\"number\"==y)g='\"'+c+'\"';else{if(\"string\"!=y)continue;g=p(c)}\"function\"!=typeof t[c]&&(d=JSON.stringify(t[c]),l.push(g+\":\"+d))}return\"{\"+l.join(\", \")+\"}\"}return\"null\"}}window.localStorage?(t.localLoad=function(t,n){var e=window.localStorage.getItem(t);if(null===e)return n;try{e=JSON.parse(e)}catch(o){e=n}return e},t.localSave=function(t,n){window.localStorage.setItem(t,JSON.stringify(n))},t.sessionLoad=function(t,n){var e=window.sessionStorage.getItem(t);return null===e?n:JSON.parse(e)},t.sessionSave=function(t,n){window.sessionStorage.setItem(t,JSON.stringify(n))}):(t.localLoad=function(t){var n,e=\"\"+document.cookie,o=e.indexOf(t);return-1==o||\"\"==t?null:(n=e.indexOf(\";\",o),-1==n&&(n=e.length),JSON.parse(decodeURIComponent(e.substring(o+t.length+1,n))))},t.localSave=function(t,n){var e=365,o=new Date,r=new Date;r.setTime(o.getTime()+864e5*e),document.cookie=t+\"=\"+encodeURIComponent(JSON.stringify(n))+\";expires=\"+r.toGMTString()}),void 0===window.console&&(window.console={log:function(){},info:function(){},warn:function(){},error:function(){}});var g,d=[\"log\",\"info\",\"warn\",\"error\"];for(g=0;g<d.length;g++)void 0===window.console[d[g]]&&(window.console[d[g]]=function(){});return t}();"}}