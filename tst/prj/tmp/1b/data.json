{"needs":[],"includes":["/home/tolokoban/Code/github/ToloFrameWork/src/cls/WTag.css"],"timestamp":0,"tags":{"def":{"needs":[],"functions":{"fire":{"comment":"*\n         * Fire a \"signal\" up to the parents widgets.\n         * If a slot returns false, the event is fired up to the parents.\n         *\n         * @param signal Name of the signal to trigger.\n         * @param arg Optional argument to sent with this signal.\n         * @param emitter Optional reference to the signal's emitter.\n         * @memberof WTag\n         ","args":["signal","arg","emitter"]},"registerSignal":{"comment":"*\n         * Register a  listener (the  function \"slot\") for  the signal\n         * \"signal\". If  this slot  returns true, the  signal continue\n         * its ascension towards parent widgets.\n         *\n         * @param signal Name of the signal to catch.\n         * @param slot Function to call to process this signal\n         * @memberof WTag\n         * @inner\n         * @memberof WTag\n         ","args":["signal","slot"]},"unregisterSignal":{"comment":"*\n         * Stop listening for the \"signal\".\n         * @memberof WTag\n         ","args":["signal"]},"slot":{"comment":"*\n         * Call the slot mapped to the \"signal\".\n         * @param signal : name of the signal on which this object may be registred.\n         * @param arg : argument to pass to the registred slot.\n         * @memberof WTag\n         ","args":["signal","arg"]},"parentElement":{"comment":"*\n         * Get the parent element.\n         * @memberof WTag\n         ","args":[]},"parentWidget":{"comment":"*\n         * Get the parent widget.\n         * @memberof WTag\n         ","args":[]},"lang":{"comment":"*\n         * Return or set the current language.\n         * @memberof WTag\n         ","args":["id"]},"findElement":{"comment":"*\n         * Get  an  element  with   this  `name`  among  this  element's\n         * children.\n         * @memberof WTag\n         ","args":["name"]},"findWidget":{"comment":"*\n         * Get the widget  mapped to the element with  this `name` among\n         * this element's children.\n         * @memberof WTag\n         ","args":["name"]},"findDataBinding":{"comment":"*\n         * @description\n         * Databindings are scoped and stored in the `$data` property of a DOM element.\n         * We always take data from the nearest parent element.\n         *\n         * @param {string} name name of the data binding.\n         * @return  object representing  data bindings.  The key  is the\n         * name of  the data and the  value is a two-items  array. First\n         * item is the current value for this data, and second item is a\n         * list of all listeners.\n         * @memberof WTag\n         ","args":["name"]},"data":{"comment":"*\n         * Set/Get bindable data.\n         * @memberof WTag\n         ","args":["name","value"]},"fireData":{"comment":"*\n         * @description\n         * Simulate a data change.\n         * @param {string|object} name name of the data, or the data binding object itself.\n         * @memberof WTag\n         ","args":["name"]},"defineLocalData":{"comment":"*\n         * @description\n         * Define a local data binding.\n         * @param {string} name Name of this data.\n         * @param value Initial value.\n         * @memberof WTag\n         ","args":["name","value"]},"bindData":{"comment":"*\n         * Bind to data updates.\n         * When the data changed, \n         * @memberof WTag\n         ","args":["name"]},"unbindData":{"comment":"*\n         * Detach this object from data binding.\n         * \n         * @param {string} name Name of the data to unbind.\n         * @memberof WTag\n         ","args":["name"]},"onDataChanged":{"comment":"*\n         * Internal method called when a data's value changes.\n         * @param {string} name Name of the data.\n         * @param value Value of the data.\n         * @memberof WTag\n         ","args":["name","value"]},"destroy":{"comment":"*\n         * @description\n         * Remove all bindings.\n         * @memberof WTag\n         ","args":[]}},"comment":"*\n * Tous les générateurs  de wtags héritent de cette  classe qui contient\n * des fonctions utiles communes.\n *\n * @class WTag\n * @namespace WTag\n ","name":"WTag","init":"*\n     * @constructs WTag\n     "},"zip":"window[\"TFW::WTag\"]={classInit:function(t){$$(\"dom.Util\"),t.globalSlots={}},init:function(){this._widgetCleanUp={signals:[],globalSignals:[],dataBindings:[]};var t;if(t=\"object\"==typeof this._id?this._id:document.getElementById(this._id),!t)throw new Error('There is no element with id \"'+this._id+'\"!');t.$widget=this,this._element=t,this._slots={}},functions:{fire:function(t,n,e){var i,a=this;if(\"undefined\"==typeof e&&(e=this),console.log(\"fire(\"+t+\")\",n),\"@\"==t.charAt(0)&&(i=$$.statics(\"WTag\"),i&&(i=i.globalSlots[t],i?i[1].call(i[0],n,t,e):console.error('[WTag.fire] Nothing is binded on global signal \"'+t+'\"!'))),\"$\"==t.charAt(0))this.data(t.substr(1).trim(),n);else{for(;a;){if(i=a._slots[t],\"function\"==typeof i&&!1!==i.call(a,n,t,e))return;a=a.parentWidget()}console.warning(\"Signal lost: \"+t+\"!\")}},registerSignal:function(t,n){\"@\"==t.charAt(0)?$$.statics(\"WTag\").globalSlots[t]=[this,n]:this._slots[t]=n},unregisterSignal:function(t){delete this._slots[t]},slot:function(t,n){var e=this._slots[t];return e?(e.call(this,n,t),!0):!1},parentElement:function(){return this._element.parentNode},parentWidget:function(){for(var t=this._element;t.parentNode;)if(t=t.parentNode,t.$widget)return t.$widget;return null},lang:function(t){if($$.App||($$.App=this),!$$.App._languages){var n=[],e=document.createElement(\"style\"),i=document.querySelectorAll(\"[lang]\");document.head.appendChild(e),$$.App._langStyle=e;for(var a=0;a<i.length;a++){var r=i[a];for(o=r.getAttribute(\"lang\"),s=!1,l=0;l<n.length;l++)if(n[l]==o){s=!0;break}s||n.push(o)}$$.App._languages=n}var o,l,s,d,f;if(n=$$.App._languages,void 0===t)return o=$$.lang(),o||(o=navigator.language||navigator.browserLanguage||\"fr\",o=o.substr(0,2)),$$.lang(o),o;for(s=!1,l=0;l<n.length;l++)if(n[l]==t){s=!0;break}for(s||(t=n[0]),f=\"\",d=!0,l=0;l<n.length;l++)o=n[l],o!=t&&(d?d=!1:f+=\",\",f+=\"[lang=\"+o+\"]\");$$.App._langStyle.textContent=f+\"{display: none}\",$$.lang(t)},findElement:function(t){if(\"undefined\"==typeof t)return this._element;var n=this._element.querySelector(\"[name='\"+t+\"']\");if(!n)throw new Error(\"[WTag.get] Can't find child [name=\\\"\"+t+'\"] in element \"'+this._id+'\"!');return n},findWidget:function(t){if(\"undefined\"==typeof t)return this;var n=this.findElement(t);return n?n.$widget:null},findDataBinding:function(t){for(var n,e,i=this.findElement();i&&(e=i,!(e.$data&&t in e.$data))&&\"html\"!=e.nodeName.toLowerCase();)i=e.parentNode;return n=e.$data[t],\"undefined\"==typeof n&&(n=[\"\",[]],e.$data[t]=n),n},data:function(t,n){var e=this.findDataBinding(t);return\"undefined\"==typeof n?e[0]:void(n!==e[0]&&(e[0]=n,this.fireData(e)))},fireData:function(t){var n=t;\"string\"==typeof t&&(n=this.findDataBinding(t)),n[1].forEach(function(e){e!==this&&e.onDataChanged(t,n[0])})},defineLocalData:function(t,n){var e=this.findElement();this._dataBinding||(e.$data={}),e.$data[t]=[n,[]]},bindData:function(t){var n=this.findDataBinding(t);n[1].push(this)},unbindData:function(t){var n,e,i=this.findDataBinding(t);for(n=0;n<i[1].length;n++)if(e=i[1][n],this===e)return i[1].splice(n,1),!0;return!1},onDataChanged:function(t,n){console.log(\"[WTag.onDataChanged] \"+t+\" := \"+n)},destroy:function(){}}};"}}